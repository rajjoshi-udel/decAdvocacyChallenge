---
title: "Patrick's Auto Shop: Scheduling Strategy Report"
subtitle: "Data-Driven Recommendations for Maximum Productivity"
format:
  html:
    theme: cosmo
execute:
  echo: false
  eval: true
  warning: false
  message: false
---

```{python}
#| echo: false
#| include: false
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats

# Set style
sns.set_style("whitegrid")
plt.rcParams['figure.figsize'] = (12, 6)
plt.rcParams['font.size'] = 11

# Load the data
carsDF = pd.read_csv("carsFixed.csv")

# Calculate impact metrics
impact = carsDF.groupby(['shopID', 'boss'])['carsFixed'].agg(['mean', 'count', 'std']).round(2)
impact_diff = impact.groupby('shopID')['mean'].diff().dropna()
impact_summary = carsDF.groupby('shopID').apply(
    lambda x: pd.Series({
        'mean_without': x[x['boss']==0]['carsFixed'].mean(),
        'mean_with': x[x['boss']==1]['carsFixed'].mean(),
        'gain': x[x['boss']==1]['carsFixed'].mean() - x[x['boss']==0]['carsFixed'].mean(),
        'days_without': (x['boss']==0).sum(),
        'days_with': (x['boss']==1).sum()
    })
).round(2)
impact_summary = impact_summary.sort_values('gain', ascending=False)
```

# Where Should Patrick Be? A Data-Driven Scheduling Strategy

## Executive Summary

After analyzing 250 days of productivity data across your 5 shops, here's the bottom line: **Focus on Shop 4 and Shop 2**. These shops show the biggest productivity boost when you're present—about 13 and 10 extra cars per day, respectively. 

**The Recommendation:** Prioritize Shop 4 (highest impact), then Shop 2. Shop 3 shows the smallest benefit from your presence, so you can visit your brother there without worrying about lost productivity elsewhere.

---

## What the Data Shows

```{python}
#| label: fig-all-data
#| fig-cap: "All 250 days of productivity data. Each point shows cars fixed that day. Blue = boss absent, Orange = boss present. Notice how some shops show bigger jumps when the boss is present."
#| echo: false

fig, axes = plt.subplots(1, 5, figsize=(16, 4))
shops = sorted(carsDF['shopID'].unique())
colors = {'absent': '#3498db', 'present': '#e67e22'}

for idx, shop in enumerate(shops):
    shop_data = carsDF[carsDF['shopID'] == shop]
    absent = shop_data[shop_data['boss'] == 0]
    present = shop_data[shop_data['boss'] == 1]
    
    # Add jitter to prevent overlap
    np.random.seed(42)
    jitter_absent = np.random.normal(0, 0.15, len(absent))
    jitter_present = np.random.normal(0, 0.15, len(present))
    
    axes[idx].scatter(absent['observation'] + jitter_absent, absent['carsFixed'], 
                      alpha=0.6, s=40, color=colors['absent'], label='Boss Absent')
    axes[idx].scatter(present['observation'] + jitter_present, present['carsFixed'], 
                      alpha=0.7, s=50, color=colors['present'], label='Boss Present', marker='^')
    
    # Add mean lines
    mean_absent = absent['carsFixed'].mean()
    mean_present = present['carsFixed'].mean()
    axes[idx].axhline(mean_absent, color=colors['absent'], linestyle='--', alpha=0.5, linewidth=1.5)
    axes[idx].axhline(mean_present, color=colors['present'], linestyle='--', alpha=0.5, linewidth=1.5)
    
    axes[idx].set_title(f'Shop {shop}', fontsize=13, fontweight='bold')
    axes[idx].set_xlabel('Day', fontsize=10)
    axes[idx].set_ylabel('Cars Fixed', fontsize=10)
    axes[idx].grid(True, alpha=0.3)
    axes[idx].set_ylim(0, 75)

axes[0].legend(loc='upper left', fontsize=9)
plt.tight_layout()
plt.show()
```

This chart shows every single day of data. The blue dots are days you weren't there; the orange triangles are days you were. The dashed lines show the average for each situation.

**What jumps out:**
- **Shop 4**: Big difference between the blue and orange lines—your presence really matters here
- **Shop 2**: Also shows a clear boost when you're present
- **Shop 3**: The lines are closer together—your presence helps, but not as dramatically

```{python}
#| label: tbl-impact
#| tbl-cap: "Productivity impact by shop. 'Gain' shows how many extra cars are fixed per day when Patrick is present."
#| echo: false

display_df = impact_summary.copy()
display_df.columns = ['Avg Without Boss', 'Avg With Boss', 'Daily Gain (cars)', 'Days Without Boss', 'Days With Boss']
display_df.index.name = 'Shop'
print(display_df.to_string())
```

## The Numbers That Matter

**Shop 4** is your biggest opportunity: When you're there, they fix about **13 more cars per day** compared to when you're not. That's roughly **$390 more revenue per day** (assuming $30 per car).

**Shop 2** comes in second: About **10 extra cars per day** when you're present—roughly **$300 more revenue per day**.

**Shop 5** shows a solid **8-car boost**, while **Shop 1** shows about **7 extra cars**.

**Shop 3** has the smallest impact: Only about **3 extra cars per day** when you're there. Since you mentioned loving to visit your brother there, this is actually good news—you can visit without worrying about missing bigger opportunities elsewhere.

```{python}
#| label: fig-gain-comparison
#| fig-cap: "Daily productivity gain when Patrick is present, by shop. Higher bars mean bigger impact."
#| echo: false

fig, ax = plt.subplots(figsize=(10, 6))
bars = ax.bar(impact_summary.index, impact_summary['gain'], 
              color=['#e74c3c', '#f39c12', '#3498db', '#2ecc71', '#9b59b6'],
              alpha=0.8, edgecolor='black', linewidth=1.5)

# Add value labels on bars
for i, (shop, gain) in enumerate(zip(impact_summary.index, impact_summary['gain'])):
    ax.text(shop, gain + 0.5, f'+{gain:.1f}', 
            ha='center', va='bottom', fontsize=12, fontweight='bold')

ax.set_xlabel('Shop', fontsize=12, fontweight='bold')
ax.set_ylabel('Extra Cars Fixed Per Day', fontsize=12, fontweight='bold')
ax.set_title('Productivity Boost from Patrick\'s Presence', fontsize=14, fontweight='bold', pad=20)
ax.grid(True, alpha=0.3, axis='y')
ax.set_ylim(0, max(impact_summary['gain']) * 1.2)

plt.tight_layout()
plt.show()
```

## Recommended Scheduling Strategy

### Priority Order (Based on Data)

1. **Shop 4** - Highest impact (13 extra cars/day)
2. **Shop 2** - Strong impact (10 extra cars/day)  
3. **Shop 5** - Good impact (8 extra cars/day)
4. **Shop 1** - Moderate impact (7 extra cars/day)
5. **Shop 3** - Lowest impact (3 extra cars/day) - *Good for personal visits*

### Weekly Schedule Suggestion

If you work 5 days a week, consider this rotation:
- **Monday & Tuesday**: Shop 4 (your biggest impact)
- **Wednesday**: Shop 2 (second biggest impact)
- **Thursday**: Shop 5 or Shop 1 (depending on other priorities)
- **Friday**: Shop 3 (visit your brother, minimal productivity loss)

This maximizes your impact on the shops that need you most.

## How Confident Can You Be?

**The honest answer:** We're working with 250 days of data, which is decent but not huge. Here's what we can say:

```{python}
#| label: fig-confidence
#| fig-cap: "Range of expected productivity gains. The bars show the 95% confidence range—meaning we're 95% confident the true impact falls within these ranges."
#| echo: false

# Calculate confidence intervals
confidence_data = []
for shop in sorted(carsDF['shopID'].unique()):
    shop_data = carsDF[carsDF['shopID'] == shop]
    without = shop_data[shop_data['boss'] == 0]['carsFixed']
    with_boss = shop_data[shop_data['boss'] == 1]['carsFixed']
    
    # Two-sample t-test for confidence interval of difference
    t_stat, p_value = stats.ttest_ind(with_boss, without)
    mean_diff = with_boss.mean() - without.mean()
    
    # Standard error of difference
    se_diff = np.sqrt(without.std()**2/len(without) + with_boss.std()**2/len(with_boss))
    ci_lower = mean_diff - 1.96 * se_diff
    ci_upper = mean_diff + 1.96 * se_diff
    
    confidence_data.append({
        'shop': shop,
        'mean_gain': mean_diff,
        'ci_lower': ci_lower,
        'ci_upper': ci_upper
    })

conf_df = pd.DataFrame(confidence_data).sort_values('mean_gain', ascending=False)

fig, ax = plt.subplots(figsize=(10, 6))
x_pos = np.arange(len(conf_df))
width = 0.6

bars = ax.barh(x_pos, conf_df['mean_gain'], width, 
               color=['#e74c3c', '#f39c12', '#3498db', '#2ecc71', '#9b59b6'],
               alpha=0.8, edgecolor='black', linewidth=1.5, label='Expected Gain')

# Add error bars for confidence intervals
for i, (idx, row) in enumerate(conf_df.iterrows()):
    ax.errorbar(row['mean_gain'], i, 
                xerr=[[row['mean_gain'] - row['ci_lower']], [row['ci_upper'] - row['mean_gain']]],
                fmt='none', color='black', capsize=5, capthick=2, linewidth=1.5)

ax.set_yticks(x_pos)
ax.set_yticklabels([f'Shop {s}' for s in conf_df['shop']], fontsize=11)
ax.set_xlabel('Extra Cars Fixed Per Day', fontsize=12, fontweight='bold')
ax.set_title('Expected Productivity Gain (with 95% Confidence Range)', 
             fontsize=14, fontweight='bold', pad=20)
ax.grid(True, alpha=0.3, axis='x')
ax.axvline(0, color='black', linestyle='-', linewidth=0.8)

# Add value labels
for i, (idx, row) in enumerate(conf_df.iterrows()):
    ax.text(row['mean_gain'] + 1, i, f"{row['mean_gain']:.1f}", 
            va='center', fontsize=10, fontweight='bold')

plt.tight_layout()
plt.show()
```

**What this means in plain English:**

- **Shop 4**: We're 95% confident your presence adds between **9 and 17 extra cars per day**. The most likely value is around 13.
- **Shop 2**: We're 95% confident you add between **6 and 14 extra cars per day**. Most likely around 10.
- **Shop 3**: The range is smaller (about 0 to 6 extra cars), and the impact is less certain.

**Bottom line:** The pattern is clear—Shops 4 and 2 benefit most. But remember, these are averages. Some days will be better, some worse. Don't expect exactly 13 extra cars every single day at Shop 4.

## Future Projections: What If You Follow This Strategy?

```{python}
#| label: fig-projections
#| fig-cap: "Projected annual impact of different scheduling strategies. Strategy A prioritizes high-impact shops (4, 2, 5), Strategy B is equal time at all shops, Strategy C is current pattern."
#| echo: false

# Calculate current pattern
current_days = impact_summary['days_with'].sum()
current_total_gain = (impact_summary['gain'] * impact_summary['days_with']).sum()

# Strategy A: Focus on high-impact shops (4, 2, 5) - 50 days each
strategy_a_gain = (impact_summary.loc[4, 'gain'] * 50 + 
                   impact_summary.loc[2, 'gain'] * 50 + 
                   impact_summary.loc[5, 'gain'] * 50)

# Strategy B: Equal time (50 days each at all shops)
strategy_b_gain = impact_summary['gain'].sum() * 50

# Strategy C: Current pattern (keep existing distribution)
strategy_c_gain = current_total_gain

# Annual projections (assuming 250 working days)
annual_current = strategy_c_gain * (250 / current_days)
annual_strategy_a = strategy_a_gain * (250 / 150)  # 150 days for 3 shops
annual_strategy_b = strategy_b_gain * (250 / 250)  # 250 days for 5 shops

strategies = ['Current\nPattern', 'Equal Time\nAll Shops', 'Focus on\nShops 4, 2, 5']
gains = [annual_current, annual_strategy_b, annual_strategy_a]
colors_strat = ['#95a5a6', '#3498db', '#2ecc71']

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# Bar chart
bars = ax1.bar(strategies, gains, color=colors_strat, alpha=0.8, 
               edgecolor='black', linewidth=1.5)
for i, (strat, gain) in enumerate(zip(strategies, gains)):
    ax1.text(i, gain + 50, f'{int(gain):,}', 
            ha='center', va='bottom', fontsize=11, fontweight='bold')

ax1.set_ylabel('Extra Cars Fixed Per Year', fontsize=12, fontweight='bold')
ax1.set_title('Annual Impact: Different Scheduling Strategies', 
              fontsize=13, fontweight='bold', pad=15)
ax1.grid(True, alpha=0.3, axis='y')

# Revenue projection (assuming $30/car)
revenue_gains = [g * 30 for g in gains]
bars2 = ax2.bar(strategies, revenue_gains, color=colors_strat, alpha=0.8,
                edgecolor='black', linewidth=1.5)
for i, (strat, rev) in enumerate(zip(strategies, revenue_gains)):
    ax2.text(i, rev + 500, f'${int(rev):,}', 
            ha='center', va='bottom', fontsize=11, fontweight='bold')

ax2.set_ylabel('Extra Revenue Per Year ($)', fontsize=12, fontweight='bold')
ax2.set_title('Annual Revenue Impact (at $30/car)', 
              fontsize=13, fontweight='bold', pad=15)
ax2.grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.show()

print(f"\n**Key Insight:** By focusing on Shops 4, 2, and 5, you could add approximately {int(annual_strategy_a - annual_current):,} more cars per year compared to your current pattern.")
print(f"That's roughly ${int((annual_strategy_a - annual_current) * 30):,} in additional annual revenue.")
```

## Final Recommendations

### 1. **Immediate Action**
   - **Prioritize Shop 4**: This is your biggest opportunity. Spend more time here.
   - **Focus on Shop 2**: Second-highest impact. Make this a regular stop.
   - **Don't worry about Shop 3**: Since you enjoy visiting your brother there and the productivity impact is small, you can visit without significant opportunity cost.

### 2. **Weekly Schedule**
   - Allocate 2 days per week to Shop 4
   - Allocate 1-2 days per week to Shop 2
   - Rotate through Shops 1 and 5 for the remaining days
   - Visit Shop 3 when convenient (personal preference, minimal productivity impact)

### 3. **What to Watch For**
   - **Variability**: Some days will be better or worse than average. That's normal.
   - **Seasonal changes**: This data represents past performance. Keep tracking to see if patterns change.
   - **Other factors**: Weather, staffing, equipment issues—these all affect productivity beyond just your presence.

### 4. **The Bottom Line**
   By focusing your time on Shops 4, 2, and 5, you could potentially add **thousands of extra cars fixed per year** compared to spreading your time equally. That translates to significant revenue growth.

**Remember:** This is data-driven guidance, not a rigid rule. Use it to inform your decisions, but stay flexible based on what's happening day-to-day at each shop.

---

*Report generated from 250 days of productivity data across 5 auto repair shops.*
